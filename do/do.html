<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Include external CSS. -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.min.css">

    <!-- Include Editor style. -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/froala-editor/2.7.3/css/froala_editor.pkgd.min.css" rel="stylesheet" type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/froala-editor/2.7.3/css/froala_style.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.3.0/lodash.js"></script>
    <style media="screen">
      .tx {
        width: 500px;
      }
      .news {
        margin-top: 20px;
        background-color: rgb(151, 215, 226);
        width: 550px;
        padding: 10px;
      }
      img {
        width: 50px;
        height: 50px;
        float: left;
      }
      .username {
        margin-left: 20px;

      }
      .textDo {
        margin-left: 50px;
      }
      .newsSpan {
        margin-left: 80px;
      }
    </style>
  </head>
  <p></p>

  <body>
    <h2>Новости</h2>
    <div class="form">
      <select id="selectGrup" class="" name="">
        <option value="">Выбирите групу</option>
        <option value="FE2">FE2</option>
        <option value="FE3">FE3</option>
        <option value="FE4">FE4</option>

      </select>

      <br>
      <div class="tx">


    <textarea id="text" name="name" rows="8" cols="80" placeholder="Введите сообщение"></textarea> <br>
    </div>
    <button id="public" type="button" name="button">Опубликовать</button>


    </div>
    <div id="do">



    </div>
    <script type="text/template" id="list-template">
      <div class="list">
          <div class="news2">
            <p><%=text%></p>


                <button class="del__btn">Удалить</button>

              </div>
              </div>


    </script>

    <script type="text/javascript">

      let pub = document.getElementById('public');


      function pubOb() {
        let text = document.getElementById('text');

        let doOb = document.getElementById('do');
        let tmpl = _.template(document.getElementById('list-template').innerHTML);
        const html = document.getElementById('list-template').textContent.trim();
        const compiled = _.template(text);
        const result = compiled(text);
        console.log(result);
        let z1 = document.createElement("div");
        z1.innerHTML = result;
        doOb.appendChild(z1);

        let grup = document.getElementById("selectGrup");


        let date = new Date();
        let years = date.getFullYear();
        console.log(text.value);
        console.log(date);
        console.log(grup.value);
        let newOb = document.createElement('div');
        let newObspan = document.createElement('p');
        let textDo = document.createElement('p');
        textDo.className = "textDo";

        let userImg = document.createElement('img');
        userImg.setAttribute('src', 'http://w-hatsapp.ru/wp-content/uploads/2017/05/screenshot-2017-05-19-001-3-300x238.png');
        newObspan.className = "newsSpan";
        let username = document.createElement('span');
        username.className = "username";
        username.appendChild(document.createTextNode("Вася Пупкин" + " to " + grup.value ));

        newOb.appendChild(userImg);
        newOb.appendChild(username);
        newObspan.appendChild(document.createTextNode(date.toString() ));
        newOb.className = "news";
        newOb.appendChild(newObspan);
        textDo.appendChild(document.createTextNode(text.value));
        newOb.appendChild(textDo);
        console.log(newOb);
        let bl = document.getElementsByClassName('news');
        if (text.value.length>0) {


        if (bl.length ==0) {
          console.log(bl.length);
          doOb.appendChild(newOb);

        } else {
          let z = document.getElementsByClassName('news');
          console.log(bl.length);
          doOb.insertBefore(newOb, z[0]);
        }
}


        text.value = "";
        grup.value= "";

      };
      pub.addEventListener("click", pubOb )




    </script>

  </body>
</html>
